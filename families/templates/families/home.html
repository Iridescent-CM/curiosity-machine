{% extends "families/base.html" %}
{% load staticfiles %}

{% block js %}
  <script type="text/javascript" src="{% static 'js/libs/jquery.circliful.min.js' %}"></script>
  <script>
    $(function(){
      $('*[data-percent]').circliful();
    });
  </script>
{% endblock %}

{% block content %}
  {% include 'families/_navigation.html' %}

  <div class="row">
    <div class="col-md-4">
      <h3>Family</h3>
      <ul class="family-dashboard-section">
      {% for familymember in request.user.familymember_set.all %}
          <div class="dashboard-members">
            {% comment %} FIXME: FamilyMember as Profile above {% endcomment %}
            {% include "profiles/_avatar.html" with profile=familymember width=60 height=60 crop='thumb' gravity='faces' classes='dashboard-members-avatar' %}
            <span class="dashboard-members-username">{{ familymember.name }}</span>
          </div>
      {% endfor %}
      </ul>
    </div>

    <div class="col-md-8">
      <h3>Progress</h3>
      <div class="row family-dashboard-section family-dashboard-circles-row">
      {% for stage in stages %}
        <div class="col-xs-4 text-xs-center">
          <div
            data-percent={{stage.stats.percent_complete}}
            data-replacePercentageByText="{{stage.stats.completed}} of {{stage.stats.total}}"
            data-animationStep=20
            data-foregroundBorderWidth= 30
            data-backgroundBorderWidth= 30
            {% if stage.stats.completed == stage.stats.total %}
                data-foregroundColor = '#73AD21'
            {% endif %}
            data-backgroundColor= '#666'
            data-fontColor= '#666'
          ></div>
          <p>Stage {{stage.number}}</p>
        </div>
      {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}
