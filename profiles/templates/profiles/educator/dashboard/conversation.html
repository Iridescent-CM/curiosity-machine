{% extends "curiositymachine/layout/base.html" %}
{% load widget_tweaks %}

{% block title %}{{ student.username }}'s Conversation{% endblock %}
{% block body-classes %}educator-dashboard educator-dashboard-conversation{% endblock %}

{% block js %}
  {{ comment_form.media }}
{% endblock %}

{% block content %}
{% include 'profiles/educator/dashboard/_header.html' %}
<div class="container">
  {% url "profiles:educator_dashboard_progress_conversation" as base_url %}
  {% include 'profiles/educator/dashboard/_navigation.html' with membership_selection_base_url=base_url%}

  <div class="row pb-1">
    <div class="col-md-12">
      <h2>{{ student.username }}'s Conversation on {{ progress.challenge.name }}</h2>
      <a href="{% url "profiles:educator_dashboard_student_detail" student_id=student.id %}">
        &larr; Back to {{ student.username }}'s Progress
      </a>
    </div>
  </div>
</div>

<div class="container">
  <div class="row mb-3">
    <div class="col-md-3">
      <div class="card card-module">
        <div class="card-block card-block-title text-xs-center">
          <div class="card-avatar">
            {% include "_avatar.html" with profile=student.profile width=60 height=60 crop='thumb' gravity='faces' %}
          </div>
          {% if student.first_name or student.last_name %}
          {{ student.first_name }}
          <br>
          {{ student.last_name }}
          {% else %}
          <em>No name provided</em>
          {% endif %}
          <br>
          <strong>{{ student.username }}</strong>
        </div>
        <div class="card-block">
          <!-- Something should go here -->
        </div>
      </div>
    </div>
    <div class="col-md-9">
      <div class="card">
        <div class="card-block">
          {% url 'challenges:comments:comments' challenge_id=progress.challenge.id username=progress.student.username stage='plan' as comment_url %}
          <form method="POST" action="{{ comment_url }}">
            {% csrf_token %}
            {{ comment_form.text|attr:"placeholder:Write your feedback here." }}
            {{ comment_form.visual_media }}
            <input type="submit" class="btn btn-primary" />
          </form>
        </div>
      </div>

      {% for comment in comments %}
      {% include 'profiles/educator/dashboard/_conversation_comment.html' with comment=comment %}
      {% endfor %}

    </div>
  </div>
</div>
{% endblock %}
