{% load unread_count %}
{% load resized %}

<div class="grid-33 tablet-grid-50 mobile-grid-100">
  <div class="challenge-card">
    <div class="favorites-filter" data-set-url="{% url 'challenges:set_favorite' challenge.id 'favorite' %}" data-clear-url="{% url 'challenges:set_favorite' challenge.id 'unfavorite' %}" data-challenge-id="{{ challenge.id }}">
      <input id="favorite-star-{{ challenge.id }}" class="favorites-checkbox" type="checkbox" name="favorite-{{ challenge.id }}" {% if challenge.id in favorite_challenges %}checked=checked{% endif %} disabled>
      <label for="favorite-{{ challenge.id }}"><i class="icon-star-full"></i></label>
    </div>

    {% if challenge in request.user.challenges.all %}
      <a href="{% url 'challenges:challenge_progress' challenge_id=challenge.id username=request.user.username %}">
    {% else %}
      <a href="{% url 'challenges:challenge' challenge.id %}">
    {% endif %}
      <div class="challenge-card-title">
        <p>{{ challenge.name }}</p>
      </div>
    </a>
    {% if challenge in request.user.challenges.all %}
      <a href="{% url 'challenges:challenge_progress' challenge_id=challenge.id username=request.user.username %}" class="action-img">
    {% else %}
      <a href="{% url 'challenges:challenge' challenge.id %}" class="action-img">
    {% endif %}
      {% if challenge.image %}
        <img src="{% resized challenge.image.url width=300 height=170 crop='fill' %}">
      {% elif challenge.video.encodings_generated %}
        {{ challenge.video.output_videos.all.0.thumbnail }}
      {% endif %}
    </a>
    <div class="inspired-by" id="inspired-by-boeing">Inspired by <i class="icon-boeing-logo"></i></div>
    <div class="challenge-card-description">
      <small>{{ challenge.description | truncatechars:200 }}</small>
    </div>
  </div>
</div>